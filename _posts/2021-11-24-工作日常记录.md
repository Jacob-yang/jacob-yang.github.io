

# 1.java stream

## 	对集合中的对象按指定字段进行分组统计并排序

	>在一个list集合中的对象有相同的name，我需要把相同name的对象的total进行汇总计算，并且根据total倒序排序

```java
/**
 * 定义一个对象，这里使用了lombok的注解
 */
@Data
@Accessors(chain = true)
class Good {
    private String name;
    private Integer total;
}

public class Test4 {
    public static void main(String[] args) {

        List<Good> list = new ArrayList<>();
        // 创建几个对象放在list集合中
        list.add(new Good().setName("xiaomi").setTotal(2));
        list.add(new Good().setName("huawei").setTotal(2));
        list.add(new Good().setName("apple").setTotal(2));
        list.add(new Good().setName("xiaomi").setTotal(2));


        List<Good> collect1 = list.stream()
                // 根据name进行分组
                .collect(Collectors.groupingBy(Good::getName))
                .entrySet()
                .stream()
                .map(entry -> {
                    String key = entry.getKey();
                    List<Good> value = entry.getValue();
                    Integer sum = value.stream().mapToInt(Good::getTotal).sum();
                    return new Good().setName(key).setTotal(sum);
                })
                // 根据total倒序排序
                .sorted(Comparator.comparing(Good::getTotal).reversed())
                .collect(Collectors.toList());
        System.out.println(collect1.toString());
    }
}
```

## 将对象List中的某个字段放到新的List中

```
List<String> ids = list.stream().map(Rq::getId).collect(Collectors.toList());
```



---

---



# 2.lombok

1.链式编程

```java
@Accessors(chain = true)


```





---

---



# 3.mybatis

## 1.查询起始到结束时间的数据

```
<if test="startDate != null">
    <![CDATA[
AND rb.create_time >= CONCAT(#{startDate},' 00:00:00')
]]> </if>
<if test="endDate != null"> <![CDATA[
AND rb.create_time <= CONCAT(#{endDate},' 23:59:59')
]]> </if>
```

## 2.for循环

1. List<String>

```
<foreach item="item" collection="list" open="(" separator="," close=")">
            #{item}
        </foreach>
```

2. Map<String, Object> map  

>```
>map.put("ids",ids);
>map.put("projectId",project);
>```

```xml
<foreach item="id" collection="ids" open="(" separator="," close=")">
            #{id}
        </foreach>
```

3. array数组

   ```xml
   <foreach collection="array" index="index" item="item" open="(" separator="," close=")">
              #{item}
         </foreach>
   ```


## 3. NOW() 用法

1. 当前0点时间

   ```xml
   select * FROM rental_tenant_record WHERE plan_end_time=DATE_FORMAT(NOW(),'%Y-%m-%d 00:00:00')
   ```

   ```
   plan_end_time=DATE_FORMAT(#{toDate},'%Y-%m-%d 00:00:00')
   ```

   



---



# 4.function

## 1.Convert类

###  	String "1,2,3,4"  ---->  List(1,2,3,4)

   1. ```java
      String str="1,2,3,4"
      List regionPId = Convert.convert(List.class, str); //hutool
      ```

      ### 数组转换为集合

   2. ```
      Object[] a = {"a", "你", "好", "", 1};
      List<?> list = Convert.convert(List.class, a);
      List<?> list = Convert.toList(a);
      ```

   3. 

##  2.定时任务(task)

 1. ```
    package com.djfy.antifraud.task;
    
    import cn.hutool.core.collection.CollectionUtil;
    import com.djfy.antifraud.domain.RentalTenantRecord;
    import com.djfy.antifraud.service.IRentalRoomService;
    import com.djfy.antifraud.service.IRentalTenantRecordService;
    import org.springframework.beans.factory.annotation.Autowired;
    import org.springframework.scheduling.annotation.Async;
    import org.springframework.scheduling.annotation.EnableAsync;
    import org.springframework.scheduling.annotation.EnableScheduling;
    import org.springframework.scheduling.annotation.Scheduled;
    import org.springframework.stereotype.Component;
    
    import java.time.LocalDateTime;
    import java.util.List;
    
    @Component
    @EnableScheduling   // 1.开启定时任务
    @EnableAsync        // 2.开启多线程
    public class MultithreadScheduleTask {
    
        @Autowired
        private IRentalTenantRecordService tenantRecordService;
        @Autowired
        private IRentalRoomService rentalRoomService;
        @Async
        @Scheduled(cron = "0 0 12 * * ?")
        public void first() throws InterruptedException {
            System.out.println("第一个定时任务开始 : " + LocalDateTime.now().toLocalTime() + "\r\n线程 : " + Thread.currentThread().getName());
            rentalRoomService.updateByIds();
        }
    
        @Async
        @Scheduled(cron = "0 30 11 * * ?")
        public void second() throws InterruptedException {
            System.out.println("第二个定时任务开始 : " + LocalDateTime.now().toLocalTime() + "\r\n线程 : " + Thread.currentThread().getName());
            List<RentalTenantRecord> rentalTenantRecords = tenantRecordService.selectRecordByDate();
            if(CollectionUtil.isEmpty(rentalTenantRecords)){
                for (RentalTenantRecord rentalTenantRecord : rentalTenantRecords) {
                    System.out.println(rentalTenantRecord.getRoomId());
                }
            }
    
        }
    
    }
    
    ```

    

# 5.Json

## hutool

```java
String res; //对象 {}
JSONObject jsonObject = JSONUtil.parseObj(res);
```

```java
String body; //list[{},{}]
JSONArray array = JSONUtil.parseArray(body);
Object o = array.get(0);
```





---



# 6.java Date

1.获取当前时间的前一天

```java
SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd");
 
  Date date = new Date();
 
  Calendar now = Calendar.getInstance();
  now.setTime(date);
 
  System.out.println(sdf.format(now.getTime()));
 
  now.add(Calendar.DAY_OF_MONTH, -1);
 
  System.out.println(now.getTime());
        
  System.out.println(sdf.format(now.getTime()));
```

运行结果：

```java
2017-09-21
Wed Sep 20 14:37:24 CST 2017
2017-09-20
```



# 7.拦截





# 8.pom.xml

### 1.导入外部jar

```
<dependency>
            <groupId>ctwing.ctg.core</groupId>
            <artifactId>ctwing-core</artifactId>
            <version>1.0</version>
            <scope>system</scope>
            <systemPath>${project.basedir}/src/main/resources/lib/ctwing-biz-1.0.jar</systemPath>
        </dependency>
```

